Attention! This code was written in 2018 without knowledge of oop and other things
